{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/utils.js","../../src/observer/index.js","../../src/state.js","../../src/compiler/astParser.js","../../src/compiler/index.js","../../src/init.js","../../src/index.js"],"sourcesContent":["const originArrMethods = Array.prototype,\n      newArrMethods = Object.create(originArrMethods);\n\nconst ARR_METHODS = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'reverse',\n  'sort',\n  'splice'\n];\n\nARR_METHODS.map((method) => {\n  newArrMethods[method] = function (...args) {\n    const result = originArrMethods[methods].apply(this, args),\n          ob = this.__ob__;\n\n    let newArr;\n\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        newArr = args;\n        break;\n      case 'splice':\n        newArr = args.slice(2);\n        break;\n      default:\n        break;\n    }\n\n    if (newArr) ob.observeArr(newArr);\n\n    return result;\n  }\n})\n\nexport {\n  newArrMethods\n}","function proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[target][key];\n    },\n    set(newValue) {\n      if (vm[target][key] === newValue) return;\n      vm[target][key] = newValue;\n    }\n  })\n}\n\nfunction isObject (value) {\n  return typeof value === 'object' && value !== null;\n}\n\nfunction isArray (value) {\n  return Array.isArray(value);\n}\n\nfunction setConstantProperty (data, key, value) {\n  Object.defineProperty(data, key, {\n    enumerable: false,\n    configurable: false,\n    value\n  });\n}\n\nexport {\n  proxy,\n  isObject,\n  isArray,\n  setConstantProperty\n}","import { newArrMethods } from \"./array\";\nimport { isObject, isArray, setConstantProperty } from '../utils';\n\nclass Observer {\n  \n  constructor(data) {\n    setConstantProperty(data, '__ob__', this);\n\n    if (isArray(data)) {\n      data.__proto__ = newArrMethods;\n      this.observeArr(data);\n    } else {\n      this.walk(data);\n    }\n  }\n\n  walk (data) {\n    const keys = Object.keys(data);\n\n    keys.map((key) => {\n      defineReactive(data, key, data[key]);\n    });\n  }\n\n  observeArr (data) {\n    data.map((item) => {\n      observe(item);\n    });\n  }\n}\n\nfunction defineReactive (data, key, value) {\n  observe(value);\n  Object.defineProperty(data, key, {\n    get () {\n      console.log('响应式获取：' + value);\n      return value;\n    },\n    set (newValue) {\n      if (value === newValue) return;\n      console.log('响应式设置：' + key + ' = ' + newValue);\n      observe(newValue);\n      value = newValue;\n    }\n  }) \n}\n\nfunction observe (data) {\n  if (!isObject(data) || data.__ob__) { \n    return data;\n  }\n\n  new Observer(data);\n}\n\nexport {\n  observe\n}","import { observe } from \"./observer\";\nimport { proxy } from './utils';\n\nfunction initState (vm) {\n  const options = vm.$options;\n\n  if (options.props) {\n    initProps(vm);\n  }\n\n  if (options.methods) {\n    initMethods(vm);\n  }\n\n  if (options.data) {\n    initData(vm);\n  }\n\n  if (options.computed) {\n    initComputed(vm);\n  }\n\n  if (options.watch) {\n    initWatch(vm);\n  }\n}\n\nfunction initProps (vm) {}\n\nfunction initMethods (vm) {}\n\nfunction initData (vm) {\n  let data = vm.$options.data;\n\n  vm._data = data = typeof data === 'function' ? data.call(vm) : data;\n  \n  for (let key in data) {\n    proxy(vm, '_data', key);\n  }\n  \n  observe(data);\n}\n\nfunction initWatch (vm) {}\n\nfunction initComputed (vm) {}\n\nexport {\n  initState\n}","\r\n\r\n/* \r\n\r\n  <div id=\"app\" style=\"color: red;font-size: 20px;\">\r\n    你好，{{name}}\r\n    <span class=\"text\" style=\"color: green;\">{{age}}</span>\r\n  </div>\r\n\r\n**/\r\n\r\nfunction parseHtmlToAst(html){\r\n  console.log(html)\r\n}\r\n\r\nexport {\r\n  parseHtmlToAst\r\n}","import { parseHtmlToAst } from './astParser';\r\n\r\n// 这个方法是将html转换成render函数\r\nfunction compileToRenderFunction(html){\r\n  // parseHtmlToAst()将html先转换成AST\r\n  const ast = parseHtmlToAst(html);\r\n  console.log(ast);\r\n}\r\n\r\nexport {\r\n  compileToRenderFunction\r\n}","import { initState } from \"./state\";\nimport { compileToRenderFunction } from './compiler';\n// import { mountComponent } from './lifecycle';\n\nfunction initMixin (Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n\n    vm.$options = options;\n\n    initState(vm);\n\n    if (vm.$options.el) {\n      // 挂载函数   Vue.prototype.$mount\n      vm.$mount(vm.$options.el);\n    }\n  }\n\n  Vue.prototype.$mount = function (el) {\n    const vm = this,\n          options = vm.$options;\n    \n    el = document.querySelector(el),\n    vm.$el = el;\n\n    if (!options.render) {\n      let template = options.template;\n\n      if (!template && el) {\n        // dom.outerHTML包含自己，而dom.innerHTML不包含自己\n        template = el.outerHTML;\n      }\n\n      const render = compileToRenderFunction(template);\n      options.render = render;\n    }\n\n    // mountComponent(vm);\n  } \n}\n\nexport {\n  initMixin\n}","import { initMixin } from './init';\n// import { lifecycleMixin } from './lifecycle';\n// import { renderMixin } from './vdom';\n\nfunction Vue (options) {\n  this._init(options);\n}\n\ninitMixin(Vue);\n// lifecycleMixin(Vue);\n// renderMixin(Vue);\n\nexport default Vue;\n\n"],"names":["originArrMethods","Array","prototype","newArrMethods","Object","create","ARR_METHODS","map","method","args","result","methods","apply","ob","__ob__","newArr","slice","observeArr","proxy","vm","target","key","defineProperty","get","set","newValue","isObject","value","isArray","setConstantProperty","data","enumerable","configurable","Observer","constructor","__proto__","walk","keys","defineReactive","item","observe","console","log","initState","options","$options","props","initData","computed","watch","_data","call","parseHtmlToAst","html","compileToRenderFunction","ast","initMixin","Vue","_init","el","$mount","document","querySelector","$el","render","template","outerHTML"],"mappings":"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"}